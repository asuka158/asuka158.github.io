<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>


    <meta name="description" content="单调队列&#x2F;单调栈优化DP        滑动窗口、单调队列、单调栈、DP优化">
<meta property="og:type" content="article">
<meta property="og:title" content="单调队列&#x2F;单调栈优化DP">
<meta property="og:url" content="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/index.html">
<meta property="og:site_name" content="Asuka">
<meta property="og:description" content="单调队列&#x2F;单调栈优化DP        滑动窗口、单调队列、单调栈、DP优化">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/78612c708b12af63016e47b8ec003699.png">
<meta property="og:image" content="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/73f1c11d610d9514440846d401dae4de.png">
<meta property="og:image" content="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/2c0e036c087b3b58be225feaa1d1024f.png">
<meta property="og:image" content="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/a39f2eee7bbb7adef8e75600dca3f947.png">
<meta property="og:image" content="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/d0dd49885da11b3eaf7d9474f9fb9447.png">
<meta property="og:image" content="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/0ba2312fc95cfe438806ff37527379f7.png">
<meta property="og:image" content="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/88ccd17a5192c24c639429a7d034e2b2.png">
<meta property="og:image" content="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/d7da999b52268376635128f239cbf26f.png">
<meta property="og:image" content="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/94f45dba8f4d9c28f5c0c1b6b2a4e036.png">
<meta property="og:image" content="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/3d56f257a2c18fed9fe72b83d2db1c1a.png">
<meta property="og:image" content="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/04f88e44f765181c1ccd9479cd9e4a7b.png">
<meta property="og:image" content="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/83290cbd166cf5f2417c297be38e2e6a.png">
<meta property="og:image" content="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/60d440efaeb800b2283a0ff878264fe5.png">
<meta property="og:image" content="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/c8b65434977162e856f7355cf74bb10b.png">
<meta property="og:image" content="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/1497b121eb5796d281ee7dd36ec930c8.png">
<meta property="og:image" content="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/6efaf0c7f4ab0bc2770d4fa7d3ad0a6f.png">
<meta property="og:image" content="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/016b693039c580ca26e453d8fe39e464.png">
<meta property="og:image" content="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/ac933cb8d03880a186b9810fdab648de.png">
<meta property="og:image" content="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/3b037bdc79638c04d9d9d3aacc859d28.png">
<meta property="og:image" content="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/b1204eee30fdc8610b05786a07723012.png">
<meta property="og:image" content="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/61d667061376a9b9588cbeac06f6a5cc.png">
<meta property="og:image" content="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/172a8302125abb4035ffdd377aa6f16f.png">
<meta property="og:image" content="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/a861c53c156d8edaad6c5a9aa1f4ca4b.png">
<meta property="og:image" content="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/1de67106f57af303b9bb963de67a3079.png">
<meta property="og:image" content="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/55b54c960fa31c4dd2f54275c08b1de6.png">
<meta property="og:image" content="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/016b693039c580ca26e453d8fe39e464-172236852184526.png">
<meta property="og:image" content="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/37bc0be278f5c2c2e5fb7604d265173d.png">
<meta property="og:image" content="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/1551f106df7eceffa6462d5d3729ae95.png">
<meta property="og:image" content="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/e0f64eceb49d6e8a61f074fd31a2d233.png">
<meta property="og:image" content="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/b7274956152febba7640ebfb67851834.png">
<meta property="og:image" content="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/7d7b5244a73c0aa14c94ab1a0aaddf33.png">
<meta property="og:image" content="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/13752590745cf3a8f3db55fa6a7739f5-172236927170935.png">
<meta property="og:image" content="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/7b8893ab0abbdaded9da9d361358e5c7.jpeg">
<meta property="article:published_time" content="2022-11-03T11:41:13.000Z">
<meta property="article:modified_time" content="2024-07-30T19:25:49.000Z">
<meta property="article:author" content="Asuka">
<meta property="article:tag" content="动态规划DP">
<meta property="article:tag" content="DP优化">
<meta property="article:tag" content="单调栈">
<meta property="article:tag" content="单调队列">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/78612c708b12af63016e47b8ec003699.png">


<link rel="canonical" href="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/","path":"2022/11/03/单调队列-单调栈优化dp/","title":"单调队列/单调栈优化DP"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>单调队列/单调栈优化DP | Asuka</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Asuka</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-number">1.</span> <span class="nav-text">
    单调队列&#x2F;单调栈优化DP
</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80-%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97"><span class="nav-number">1.1.</span> <span class="nav-text">一. 单调队列</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#NC50528-%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3"><span class="nav-number">1.1.1.</span> <span class="nav-text">NC50528    滑动窗口</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C-%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97%E4%BC%98%E5%8C%96dp"><span class="nav-number">1.2.</span> <span class="nav-text">二. 单调队列优化dp</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-daimayuan-875-%E9%80%89%E5%85%83%E7%B4%A0%EF%BC%88%E6%95%B0%E6%8D%AE%E5%8A%A0%E5%BC%BA%E7%89%88%EF%BC%89"><span class="nav-number">1.2.1.</span> <span class="nav-text">1.daimayuan #875. 选元素（数据加强版）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#AcWing-4418-%E9%80%89%E5%85%83%E7%B4%A0"><span class="nav-number">1.2.1.1.</span> <span class="nav-text">AcWing 4418. 选元素</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%8A%A0%E5%BC%BA%E7%89%88"><span class="nav-number">1.2.1.2.</span> <span class="nav-text">数据加强版</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-C-Jump-and-Treasure%EF%BC%88Gym-103743C%EF%BC%892022%E6%B1%9F%E8%8B%8F%E7%9C%81%E8%B5%9B"><span class="nav-number">1.2.2.</span> <span class="nav-text">2. C. Jump and Treasure（Gym - 103743C）2022江苏省赛</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-P1725-%E7%90%AA%E9%9C%B2%E8%AF%BA%EF%BC%88%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97%EF%BC%89"><span class="nav-number">1.2.3.</span> <span class="nav-text">3.P1725 琪露诺（单调队列）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-AcWing-135-%E6%9C%80%E5%A4%A7%E5%AD%90%E5%BA%8F%E5%92%8C"><span class="nav-number">1.2.4.</span> <span class="nav-text">4.AcWing 135 最大子序和</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-AcWing-1087-%E4%BF%AE%E5%89%AA%E8%8D%89%E5%9D%AA"><span class="nav-number">1.2.5.</span> <span class="nav-text">5.AcWing 1087 修剪草坪</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-AcWing-1090%E7%BB%BF%E8%89%B2%E9%80%9A%E9%81%93"><span class="nav-number">1.2.6.</span> <span class="nav-text">6.AcWing 1090绿色通道</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89-%E5%8D%95%E8%B0%83%E6%A0%88"><span class="nav-number">1.3.</span> <span class="nav-text">三. 单调栈</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-P5788-%E3%80%90%E6%A8%A1%E6%9D%BF%E3%80%91%E5%8D%95%E8%B0%83%E6%A0%88"><span class="nav-number">1.3.1.</span> <span class="nav-text">1. P5788 【模板】单调栈</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-P1823-COI2007-Patrik-%E9%9F%B3%E4%B9%90%E4%BC%9A%E7%9A%84%E7%AD%89%E5%BE%85"><span class="nav-number">1.3.2.</span> <span class="nav-text">2.P1823 [COI2007] Patrik 音乐会的等待</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9B%9B-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp"><span class="nav-number">1.4.</span> <span class="nav-text">四. 单调栈优化dp</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-CF1313C2-Skyscrapers-hard-version"><span class="nav-number">1.4.1.</span> <span class="nav-text">1.CF1313C2 Skyscrapers (hard version)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-CF1407D-Discrete-Centrifugal-Jumps"><span class="nav-number">1.4.2.</span> <span class="nav-text">2.CF1407D Discrete Centrifugal Jumps</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E7%89%9B%E5%AE%A2%E5%A4%9A%E6%A0%A1%E7%AC%AC%E4%B9%9D%E5%9C%BAI-The-Great-Wall-II"><span class="nav-number">1.4.3.</span> <span class="nav-text">3.牛客多校第九场I The Great Wall II</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Asuka"
      src="/images/asuka.jpg">
  <p class="site-author-name" itemprop="name">Asuka</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">35</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">48</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/asuka.jpg">
      <meta itemprop="name" content="Asuka">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Asuka">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="单调队列/单调栈优化DP | Asuka">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          单调队列/单调栈优化DP
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-11-03 19:41:13" itemprop="dateCreated datePublished" datetime="2022-11-03T19:41:13+08:00">2022-11-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-07-31 03:25:49" itemprop="dateModified" datetime="2024-07-31T03:25:49+08:00">2024-07-31</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">算法</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 style="text-align: center;">
    单调队列/单调栈优化DP
</h1>

<p><div style="text-align: center;">
    <strong>滑动窗口、单调队列、单调栈、DP优化</strong>
</div><br><span id="more"></span></p>
<p>从这几篇博客学习的：<br><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/554269508">DP优化小技巧（单调队列/单调栈）</a><br><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/515503851">(单调队列优化DP) 代码源每日一题 Div1 选元素（数据加强版）</a><br><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/346536592">算法学习笔记(67): 单调栈</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/CK1513710764/article/details/126357276">牛客多校第九场I (单调栈优化dp/单调栈的常用套路)</a></p>
<h2 id="一-单调队列"><a href="#一-单调队列" class="headerlink" title="一. 单调队列"></a>一. 单调队列</h2><h3 id="NC50528-滑动窗口"><a href="#NC50528-滑动窗口" class="headerlink" title="NC50528    滑动窗口"></a><a target="_blank" rel="noopener" href="https://ac.nowcoder.com/acm/problem/50528">NC50528    滑动窗口</a></h3><p><img src="/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/78612c708b12af63016e47b8ec003699.png" alt="在这里插入图片描述"><br><img src="/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/73f1c11d610d9514440846d401dae4de.png" alt="img"></p>
<p><strong>主要思想：</strong><br>&emsp;&emsp;假设我们需要维护长度为$k$的区间最大值，遍历过程中，对于一个数字$a_{i+1}$，如果$a_{i+1} &gt;= a_i$，那么我们完全可以把$a_i$的影响忽略掉。因为后面的数字比你并且生命周期还比你大，所以最大值永远不可能取到$a_i$。具体在队列中的做法就是不断访问队尾元素，小于等于当前值就出队，结束后将当前元素入队。这样的话就可以保证队首元素一定是长度为$k$的区间的最大值。（当然你需要判断队首元素与当前位置距离与$k$的大小关系确定队首元素是否需要出队）。这个过程可以用deque很容易实现，数组模拟也很容易。<br><strong>AC代码：</strong><br>deque：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n, k;</span><br><span class="line"><span class="type">int</span> ar[<span class="number">1000050</span>];</span><br><span class="line">deque&lt;<span class="type">int</span>&gt; q;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;k);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;ar[i]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(!q.<span class="built_in">empty</span>() &amp;&amp; q.<span class="built_in">front</span>() + k &lt;= i) q.<span class="built_in">pop_front</span>();</span><br><span class="line">        <span class="keyword">while</span>(!q.<span class="built_in">empty</span>() &amp;&amp; ar[q.<span class="built_in">back</span>()] &gt;= ar[i]) q.<span class="built_in">pop_back</span>();</span><br><span class="line">        q.<span class="built_in">push_back</span>(i);</span><br><span class="line">        <span class="keyword">if</span>(i &gt;= k) <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, ar[q.<span class="built_in">front</span>()]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    q.<span class="built_in">clear</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(!q.<span class="built_in">empty</span>() &amp;&amp; q.<span class="built_in">front</span>() + k &lt;= i) q.<span class="built_in">pop_front</span>();</span><br><span class="line">        <span class="keyword">while</span>(!q.<span class="built_in">empty</span>() &amp;&amp; ar[q.<span class="built_in">back</span>()] &lt;= ar[i]) q.<span class="built_in">pop_back</span>();</span><br><span class="line">        q.<span class="built_in">push_back</span>(i);</span><br><span class="line">        <span class="keyword">if</span>(i &gt;= k) <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, ar[q.<span class="built_in">front</span>()]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>数组模拟：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n, k;</span><br><span class="line"><span class="type">int</span> ar[<span class="number">1000050</span>];</span><br><span class="line"><span class="type">int</span> p[<span class="number">1000050</span>];</span><br><span class="line"><span class="type">int</span> l, r;<span class="comment">//左闭右开</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;k);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;ar[i]);</span><br><span class="line">    l = <span class="number">0</span>;</span><br><span class="line">    r = <span class="number">1</span>;</span><br><span class="line">    p[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(k == <span class="number">1</span>) <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, ar[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(i - p[l] &gt;= k &amp;&amp; (l &lt; r))    l++;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>(r &gt; l &amp;&amp; ar[p[r - <span class="number">1</span>]] &gt;= ar[i]) r--;</span><br><span class="line">        p[r++] = i;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(i &gt;= k)  <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, ar[p[l]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    l = <span class="number">0</span>;</span><br><span class="line">    r = <span class="number">1</span>;</span><br><span class="line">    p[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(k == <span class="number">1</span>)  <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, ar[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(i - p[l] &gt;= k &amp;&amp; (l &lt; r))    l++;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>(r &gt; l &amp;&amp; ar[p[r - <span class="number">1</span>]] &lt;= ar[i])    r--;</span><br><span class="line">        p[r++] = i;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(i &gt;= k)  <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, ar[p[l]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="二-单调队列优化dp"><a href="#二-单调队列优化dp" class="headerlink" title="二. 单调队列优化dp"></a>二. 单调队列优化dp</h2><p>&emsp;&emsp;当我们为了实现给动态规划的<strong>复杂度降维</strong>的时候，通常就需要单调栈/队列，通常用来维护<strong>前面状态</strong>下可以取到的<strong>最大值或者最小值</strong>，然后直接进行转移。（ygg）<br><img src="/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/2c0e036c087b3b58be225feaa1d1024f.png" alt="img"></p>
<h3 id="1-daimayuan-875-选元素（数据加强版）"><a href="#1-daimayuan-875-选元素（数据加强版）" class="headerlink" title="1.daimayuan #875. 选元素（数据加强版）"></a><a target="_blank" rel="noopener" href="http://oj.daimayuan.top/problem/875">1.daimayuan #875. 选元素（数据加强版）</a></h3><p>&emsp;&emsp;首先，我们可以看数据没加强版</p>
<h4 id="AcWing-4418-选元素"><a href="#AcWing-4418-选元素" class="headerlink" title="AcWing 4418. 选元素"></a><a target="_blank" rel="noopener" href="https://www.acwing.com/problem/content/4421/">AcWing 4418. 选元素</a></h4><p><img src="/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/a39f2eee7bbb7adef8e75600dca3f947.png" alt="img"><br><img src="/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/d0dd49885da11b3eaf7d9474f9fb9447.png" alt="img"><br><strong>题意：</strong><br>&emsp;&emsp;就是对与每个长度为为$k$的子区间，至少要有一个数被选择，一共可以选择$x$个数字，目标是让选择的$x$个数字最大。<br><strong>分析：</strong><br>&emsp;&emsp;考虑dp，定义<code>dp[i][j]</code>表示选了<code>ar[i]</code>的情况下，前$i$个数字一共有$j$个被选的情况下的最大值。<br>&emsp;&emsp;状态转移方程：$dp[i][j] =max(dp[i][j],dp[i-k,i-1][j-1]+ar[i])$。复杂度$O(n^3)$。<br><strong>AC代码：</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int ll</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n, k, x;</span><br><span class="line"><span class="type">int</span> ar[<span class="number">205</span>];</span><br><span class="line"><span class="type">int</span> dp[<span class="number">205</span>][<span class="number">205</span>];</span><br><span class="line"><span class="type">int</span> ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld%lld&quot;</span>, &amp;n, &amp;k, &amp;x);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;ar[i]);</span><br><span class="line">    <span class="built_in">memset</span>(dp, <span class="number">128</span>, <span class="built_in">sizeof</span>(dp));</span><br><span class="line">    <span class="comment">//cout &lt;&lt; dp[0][0] &lt;&lt; &#x27;\n&#x27;;</span></span><br><span class="line">    dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= x; ++j)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> p = <span class="built_in">max</span>(<span class="number">0ll</span>, i - k); p &lt; i; ++p)</span><br><span class="line">            &#123;</span><br><span class="line">                dp[i][j] = <span class="built_in">max</span>(dp[i][j], dp[p][j - <span class="number">1</span>] + ar[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//cout &lt;&lt; i &lt;&lt; &#x27; &#x27; &lt;&lt; j &lt;&lt; &#x27; &#x27; &lt;&lt; dp[i][j] &lt;&lt; &#x27;\n&#x27;;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ans = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = n - k + <span class="number">1</span>; i &lt;= n; ++i) ans = <span class="built_in">max</span>(ans, dp[i][x]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="数据加强版"><a href="#数据加强版" class="headerlink" title="数据加强版"></a>数据加强版</h4><p>&emsp;&emsp;对于数据加强版，$n,k,x$的取值达到2500，$O(n^3)$一定超时。我们考虑优化，对于原来的状态转移式。$dp[i][j] =max(dp[i][j],dp[i-k,i-1][j-1]+ar[i])$，考虑以极快的速度求出$max(dp[i-k,i-1][j-1])$。本质上一个窗口大小为$k$的滑动窗口，故利用单调队列优化即可。复杂度$O(n^2)$。<br><strong>AC代码：</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n, k, x, top;</span><br><span class="line">ll ar[<span class="number">2550</span>];</span><br><span class="line">ll dp[<span class="number">2550</span>][<span class="number">2550</span>];</span><br><span class="line">ll ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;k, &amp;x);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;ar[i]);</span><br><span class="line">    <span class="built_in">memset</span>(dp, <span class="number">128</span>, <span class="built_in">sizeof</span>(dp));</span><br><span class="line">    <span class="comment">//cout &lt;&lt; dp[0][0] &lt;&lt; &#x27;\n&#x27;;</span></span><br><span class="line">    dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= x; ++j)</span><br><span class="line">    &#123;</span><br><span class="line">        deque&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">        q.<span class="built_in">push_back</span>(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">while</span>(!q.<span class="built_in">empty</span>() &amp;&amp; q.<span class="built_in">front</span>() &lt; i - k) q.<span class="built_in">pop_front</span>();</span><br><span class="line">            dp[i][j] = dp[q.<span class="built_in">front</span>()][j - <span class="number">1</span>] + ar[i];</span><br><span class="line">            <span class="keyword">while</span>(!q.<span class="built_in">empty</span>() &amp;&amp; dp[q.<span class="built_in">back</span>()][j - <span class="number">1</span>] &lt;= dp[i][j - <span class="number">1</span>]) q.<span class="built_in">pop_back</span>();</span><br><span class="line">            q.<span class="built_in">push_back</span>(i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ans = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = n - k + <span class="number">1</span>; i &lt;= n; ++i) ans = <span class="built_in">max</span>(ans, dp[i][x]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-C-Jump-and-Treasure（Gym-103743C）2022江苏省赛"><a href="#2-C-Jump-and-Treasure（Gym-103743C）2022江苏省赛" class="headerlink" title="2. C. Jump and Treasure（Gym - 103743C）2022江苏省赛"></a><a target="_blank" rel="noopener" href="https://codeforces.com/gym/103743/problem/C">2. C. Jump and Treasure（Gym - 103743C）2022江苏省赛</a></h3><p><img src="/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/0ba2312fc95cfe438806ff37527379f7.png" alt="img"><br><img src="/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/88ccd17a5192c24c639429a7d034e2b2.png" alt="img"><br><strong>题意：</strong><br>&emsp;&emsp;输入$n，q，p$,之后一行$n$个数字，之后$q$行，$q$次询问。<br>&emsp;&emsp;你现在在玩一个游戏，初始在0点，你只可以向右走，游戏有很多关，对于第$x$关，你只能走到$i$的倍数的点上，并且每步跨越的最大距离是$p$,每个点上有数字，当你到达这个点是，你的数值就会加上该点的权值，初始时你的数值为0，通关条件是到达点$n+1$及其之后的点，并且$n+1$及其之后的点的数值都为0，走到$n+1$之后的点不需要考虑他们是否是$x$的倍数，只需要考虑最大跨越距离的限制。你可以在不违规的前提下走任意多步，$q$次询问，问你对于第$x$关，通关时的最大数值。<br><strong>分析：</strong><br>&emsp;&emsp;考虑dp，定义<code>dp[i]</code>表示，对于第$x$关，走到第$i$个能到达的点时所能获得的最大价值。<br>&emsp;&emsp;转移方程：$dp[i] = max(dp[i], dp[i-p/x,i-1]+ar[i])$ (不考虑Noob的情况)。<br>&emsp;&emsp;如果暴力跑，复杂度为$O(TLE)$,依旧考虑单调队列优化取$max$的部分。复杂度$O(nlogn)$。<br><strong>AC代码：</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> io ios::sync_with_stdio(false),cin.tie(0),cout.tie(0)</span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span>  ll inf = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">int</span> n, p, q, x;</span><br><span class="line">ll ans[<span class="number">1000050</span>];</span><br><span class="line"><span class="type">int</span> ar[<span class="number">1000050</span>];</span><br><span class="line">ll dp[<span class="number">1000050</span>];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; vt[<span class="number">1000005</span>];</span><br><span class="line"><span class="type">int</span> qq[<span class="number">1000050</span>];</span><br><span class="line"><span class="type">int</span> l, r;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    io;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; q &gt;&gt; p;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) cin &gt;&gt; ar[i];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        ans[i] = -inf;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt;= n; j += i) vt[i].<span class="built_in">push_back</span>(j);</span><br><span class="line">        vt[i].<span class="built_in">push_back</span>(n + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(q--)</span><br><span class="line">    &#123;</span><br><span class="line">        cin &gt;&gt; x;</span><br><span class="line">        <span class="keyword">if</span>(ans[x] != -inf) cout &lt;&lt; ans[x] &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(x &gt; p) cout &lt;&lt; <span class="string">&quot;Noob\n&quot;</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            dp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">            l = r = <span class="number">1</span>;</span><br><span class="line">            qq[r] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; vt[x].<span class="built_in">size</span>(); ++i)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">while</span>(l &lt;= r &amp;&amp; vt[x][i] - qq[l] &gt; p) ++l;</span><br><span class="line">                dp[vt[x][i]] = dp[qq[l]] + ar[vt[x][i]];</span><br><span class="line"></span><br><span class="line">                <span class="keyword">while</span>(l &lt;= r &amp;&amp; dp[qq[r]] &lt;= dp[vt[x][i]]) --r;</span><br><span class="line">                qq[++r] = vt[x][i];</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            ans[x] = dp[n + <span class="number">1</span>];</span><br><span class="line">            cout &lt;&lt; ans[x] &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="3-P1725-琪露诺（单调队列）"><a href="#3-P1725-琪露诺（单调队列）" class="headerlink" title="3.P1725 琪露诺（单调队列）"></a><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1725">3.P1725 琪露诺（单调队列）</a></h3><p><img src="/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/d7da999b52268376635128f239cbf26f.png" alt="img"><br><strong>题意：</strong><br>&emsp;&emsp;很类似上一个题，只不过跳的方式有所不同，是给定一个$l,r$,对于当前点$i$，可以跳到$[i+l,i+r]$<br><strong>AC代码：</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> inf = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">int</span> n, l, r;</span><br><span class="line"><span class="type">int</span> ar[<span class="number">600050</span>];</span><br><span class="line"><span class="type">int</span> dp[<span class="number">600050</span>];</span><br><span class="line">deque&lt;<span class="type">int</span>&gt; q;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;l, &amp;r);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;ar[i]);</span><br><span class="line">        dp[i] = -inf;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    dp[<span class="number">0</span>] = ar[<span class="number">0</span>];</span><br><span class="line">    q.<span class="built_in">push_back</span>(<span class="number">0</span>);</span><br><span class="line">    dp[l] = ar[l];</span><br><span class="line"></span><br><span class="line">	<span class="comment">//3*n是我乱写的，反正不会超时，后面那一坨的dp值都是相同的。</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = l + <span class="number">1</span>; i &lt;= <span class="number">3</span> * n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(!q.<span class="built_in">empty</span>() &amp;&amp; q.<span class="built_in">front</span>() + r &lt; i) q.<span class="built_in">pop_front</span>();</span><br><span class="line">        <span class="keyword">while</span>(!q.<span class="built_in">empty</span>() &amp;&amp; dp[q.<span class="built_in">back</span>()] &lt;= dp[i - l]) q.<span class="built_in">pop_back</span>();</span><br><span class="line">        q.<span class="built_in">push_back</span>(i - l);</span><br><span class="line"></span><br><span class="line">        dp[i] = dp[q.<span class="built_in">front</span>()] + ar[i];</span><br><span class="line">        <span class="comment">//cout &lt;&lt; i &lt;&lt; &#x27; &#x27; &lt;&lt; dp[i] &lt;&lt; &#x27;\n&#x27;;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, dp[<span class="number">3</span> * n]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="4-AcWing-135-最大子序和"><a href="#4-AcWing-135-最大子序和" class="headerlink" title="4.AcWing 135 最大子序和"></a><a target="_blank" rel="noopener" href="https://www.acwing.com/problem/content/137/">4.AcWing 135 最大子序和</a></h3><p><img src="/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/94f45dba8f4d9c28f5c0c1b6b2a4e036.png" alt="img"><br><strong>分析：</strong><br>&emsp;&emsp;<code>dp[i]</code>表示以i为结尾的一段长度不超过m的连续子序列的和的最大。<br>&emsp;&emsp;$dp[i] = \max_{j=i-m}^{j=i-1} sum[i]-sum[j]$<br>&emsp;&emsp;单调队列维护长度为m的区间中<code>-sum[j]</code>的最大值(或者<code>sum[j]</code>的最小值)即可$O(1)$转移，总体复杂度$O(n)$。<br><strong>AC代码：</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int ll</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> endl <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> io ios::sync_with_stdio(false),cin.tie(0),cout.tie(0)</span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">3e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> inf = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> ar[maxn];</span><br><span class="line"><span class="type">int</span> sum[maxn];</span><br><span class="line"><span class="type">int</span> dp[maxn];</span><br><span class="line">deque&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt; q;</span><br><span class="line"><span class="type">bool</span> flag;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">print</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> ans = -inf;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) ans = <span class="built_in">max</span>(ans, ar[i]);</span><br><span class="line">    cout &lt;&lt; ans &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//io;</span></span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    flag = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        cin &gt;&gt; ar[i];</span><br><span class="line">        sum[i] = sum[i - <span class="number">1</span>] + ar[i];</span><br><span class="line">        <span class="keyword">if</span>(ar[i] &gt; <span class="number">0</span>) flag = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!flag) <span class="built_in">print</span>();</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        deque&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">        q.<span class="built_in">push_back</span>(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">while</span>(!q.<span class="built_in">empty</span>() &amp;&amp; i - q.<span class="built_in">front</span>() &gt; m) q.<span class="built_in">pop_front</span>();</span><br><span class="line">            dp[i] = sum[i] - sum[q.<span class="built_in">front</span>()];</span><br><span class="line">            <span class="keyword">while</span>(!q.<span class="built_in">empty</span>() &amp;&amp; -sum[i] &gt;= -sum[q.<span class="built_in">back</span>()]) q.<span class="built_in">pop_back</span>();</span><br><span class="line">            q.<span class="built_in">push_back</span>(i);</span><br><span class="line">            <span class="comment">//cout &lt;&lt; i &lt;&lt; &#x27; &#x27; &lt;&lt; dp[i] &lt;&lt; &#x27;\n&#x27;;</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> mx = -inf;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) mx = <span class="built_in">max</span>(mx, dp[i]);</span><br><span class="line">        cout &lt;&lt; mx &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="5-AcWing-1087-修剪草坪"><a href="#5-AcWing-1087-修剪草坪" class="headerlink" title="5.AcWing 1087 修剪草坪"></a><a target="_blank" rel="noopener" href="https://www.acwing.com/problem/content/1089/">5.AcWing 1087 修剪草坪</a></h3><p><img src="/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/3d56f257a2c18fed9fe72b83d2db1c1a.png" alt="img"><br><img src="/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/04f88e44f765181c1ccd9479cd9e4a7b.png" alt="img"><br><strong>分析：</strong><br>&emsp;&emsp;<code>dp[i]</code>表示前i头牛选第i头牛的最大效率<br>&emsp;&emsp;$dp[i] = \max_{j = i-k}^{j = i-1} dp[j - 1] + sum[i] - sum[j]$<br>&emsp;&emsp;单调队列维护<code>dp[j-1]-sum[j]</code>的最大值即可。<br><strong>AC代码：</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int ll</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> endl <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> io ios::sync_with_stdio(false),cin.tie(0),cout.tie(0)</span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">3e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> inf = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">int</span> n, k;</span><br><span class="line"><span class="type">int</span> ar[maxn];</span><br><span class="line"><span class="type">int</span> sum[maxn];</span><br><span class="line"><span class="type">int</span> dp[maxn];</span><br><span class="line"><span class="type">int</span> gg[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    io;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; k;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        cin &gt;&gt; ar[i];</span><br><span class="line">        sum[i] = sum[i - <span class="number">1</span>] + ar[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    deque&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    q.<span class="built_in">push_back</span>(<span class="number">0</span>);</span><br><span class="line">    gg[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(!q.<span class="built_in">empty</span>() &amp;&amp; i - q.<span class="built_in">front</span>() &gt; k) q.<span class="built_in">pop_front</span>();</span><br><span class="line">        dp[i] = sum[i] + gg[q.<span class="built_in">front</span>()];</span><br><span class="line">        gg[i] = -sum[i] + dp[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">while</span>(!q.<span class="built_in">empty</span>() &amp;&amp; gg[i] &gt;= gg[q.<span class="built_in">back</span>()]) q.<span class="built_in">pop_back</span>();</span><br><span class="line">        q.<span class="built_in">push_back</span>(i);</span><br><span class="line">        <span class="comment">//cout &lt;&lt; i &lt;&lt; &#x27; &#x27; &lt;&lt; dp[i] &lt;&lt; &#x27;\n&#x27;;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> mx = -inf;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) mx = <span class="built_in">max</span>(mx, dp[i]);</span><br><span class="line">    cout &lt;&lt; mx &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="6-AcWing-1090绿色通道"><a href="#6-AcWing-1090绿色通道" class="headerlink" title="6.AcWing 1090绿色通道"></a><a target="_blank" rel="noopener" href="https://www.acwing.com/problem/content/1092/">6.AcWing 1090绿色通道</a></h3><p><img src="/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/83290cbd166cf5f2417c297be38e2e6a.png" alt="img"><br><img src="/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/60d440efaeb800b2283a0ff878264fe5.png" alt="img"><br><strong>分析：</strong><br>&emsp;&emsp;二分答案+单调队列优化dp<br><strong>AC代码：</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int ll</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> endl <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> io ios::sync_with_stdio(false),cin.tie(0),cout.tie(0)</span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> inf = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> ar[maxn];</span><br><span class="line"><span class="type">int</span> dp[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">judge</span><span class="params">(<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    deque&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    q.<span class="built_in">push_back</span>(<span class="number">0</span>);</span><br><span class="line">    dp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(!q.<span class="built_in">empty</span>() &amp;&amp; i - q.<span class="built_in">front</span>() &gt; k) q.<span class="built_in">pop_front</span>();</span><br><span class="line">        dp[i] = dp[q.<span class="built_in">front</span>()] + ar[i];</span><br><span class="line">        <span class="keyword">while</span>(!q.<span class="built_in">empty</span>() &amp;&amp; dp[i] &lt;= dp[q.<span class="built_in">back</span>()]) q.<span class="built_in">pop_back</span>();</span><br><span class="line">        q.<span class="built_in">push_back</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> mi = inf;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = n; i &gt; n - k; --i) mi = <span class="built_in">min</span>(mi, dp[i]);</span><br><span class="line">    <span class="keyword">return</span> mi &lt;= m;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    io;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) cin &gt;&gt; ar[i];</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> l = <span class="number">0</span>, r = n;</span><br><span class="line">    <span class="keyword">while</span>(l &lt;= r)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">judge</span>(mid)) r = mid - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> l = mid + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; r &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int ll</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> endl <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> io ios::sync_with_stdio(false),cin.tie(0),cout.tie(0)</span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">5e4</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> inf = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">int</span> n, t;</span><br><span class="line"><span class="type">int</span> ar[maxn];</span><br><span class="line"><span class="type">int</span> sum[maxn];</span><br><span class="line"><span class="type">int</span> gg[maxn];</span><br><span class="line"><span class="type">int</span> dp[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">judge</span><span class="params">(<span class="type">int</span> mid)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    deque&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    <span class="built_in">memset</span>(dp, <span class="number">0</span>, <span class="built_in">sizeof</span>(dp));</span><br><span class="line">    q.<span class="built_in">push_back</span>(<span class="number">0</span>);</span><br><span class="line">    gg[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(!q.<span class="built_in">empty</span>() &amp;&amp; i - q.<span class="built_in">front</span>() &gt; mid) q.<span class="built_in">pop_front</span>();</span><br><span class="line">        dp[i] = sum[i] + gg[q.<span class="built_in">front</span>()];</span><br><span class="line">        gg[i] = -sum[i] + dp[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">while</span>(!q.<span class="built_in">empty</span>() &amp;&amp; gg[i] &gt;= gg[q.<span class="built_in">back</span>()]) q.<span class="built_in">pop_back</span>();</span><br><span class="line">        q.<span class="built_in">push_back</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> mx = -inf;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) mx = <span class="built_in">max</span>(mx, dp[i]);</span><br><span class="line">    <span class="keyword">if</span>(sum[n] - mx &gt; t) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    io;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; t;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        cin &gt;&gt; ar[i];</span><br><span class="line">        sum[i] = sum[i - <span class="number">1</span>] + ar[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(sum[n] &lt;= t) </span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="number">0</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> l = <span class="number">1</span>, r = n, mid;</span><br><span class="line">    <span class="keyword">while</span>(l &lt;= r)</span><br><span class="line">    &#123;</span><br><span class="line">        mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">judge</span>(mid)) r = mid - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> l = mid + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; r + <span class="number">1</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="三-单调栈"><a href="#三-单调栈" class="headerlink" title="三. 单调栈"></a>三. 单调栈</h2><p><strong>两大用处：</strong><br>1.NGE问题（Next Greater Element），也就是，对序列中每个元素，找到下一个比它大的元素。<br>2.两元素间所有元素均(不)大/小于这两者</p>
<h3 id="1-P5788-【模板】单调栈"><a href="#1-P5788-【模板】单调栈" class="headerlink" title="1. P5788 【模板】单调栈"></a><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P5788">1. P5788 【模板】单调栈</a></h3><p><img src="/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/c8b65434977162e856f7355cf74bb10b.png" alt="img"><br><img src="/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/1497b121eb5796d281ee7dd36ec930c8.png" alt="img"><br>（其实也可以用单调队列，不需要队首元素出队的单调队列)<br><strong>AC代码：</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">int</span> ar[<span class="number">3000050</span>];</span><br><span class="line">stack&lt;<span class="type">int</span>&gt; st;</span><br><span class="line"><span class="type">int</span> ans[<span class="number">3000050</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;ar[i]);</span><br><span class="line"></span><br><span class="line">    ans[n] = <span class="number">0</span>;</span><br><span class="line">    st.<span class="built_in">push</span>(n);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = n - <span class="number">1</span>; i &gt; <span class="number">0</span>; --i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(!st.<span class="built_in">empty</span>() &amp;&amp; ar[st.<span class="built_in">top</span>()] &lt;= ar[i]) st.<span class="built_in">pop</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!st.<span class="built_in">empty</span>()) ans[i] = st.<span class="built_in">top</span>();</span><br><span class="line">        <span class="keyword">else</span> ans[i] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        st.<span class="built_in">push</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, ans[i]);</span><br><span class="line">    <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-P1823-COI2007-Patrik-音乐会的等待"><a href="#2-P1823-COI2007-Patrik-音乐会的等待" class="headerlink" title="2.P1823 [COI2007] Patrik 音乐会的等待"></a><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1823">2.P1823 [COI2007] Patrik 音乐会的等待</a></h3><p><img src="/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/6efaf0c7f4ab0bc2770d4fa7d3ad0a6f.png" alt="img"><br><img src="/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/016b693039c580ca26e453d8fe39e464.png" alt="img"><br>（区间1~i内元素大小关系和单调栈内元素情况）<br><img src="/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/ac933cb8d03880a186b9810fdab648de.png" alt="img"><br><img src="/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/3b037bdc79638c04d9d9d3aacc859d28.png" alt="img"><br><strong>AC代码：</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int ll</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">int</span> ar[<span class="number">500050</span>];</span><br><span class="line">stack&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; &gt; st;</span><br><span class="line">pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; pi;</span><br><span class="line"><span class="type">int</span> ans, cnt;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;ar[i]);</span><br><span class="line"></span><br><span class="line">    st.<span class="built_in">push</span>(&#123;ar[<span class="number">1</span>], <span class="number">1</span>&#125;);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> cnt = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(!st.<span class="built_in">empty</span>() &amp;&amp; st.<span class="built_in">top</span>().first &lt;= ar[i])</span><br><span class="line">        &#123;</span><br><span class="line">            pi = st.<span class="built_in">top</span>();</span><br><span class="line">            st.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="comment">//cout &lt;&lt; pi.first &lt;&lt; &#x27; &#x27; &lt;&lt; pi.second &lt;&lt; &#x27;\n&#x27;;</span></span><br><span class="line">            ans += pi.second;</span><br><span class="line">            <span class="keyword">if</span>(pi.first == ar[i]) cnt = pi.second + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> cnt = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(!st.<span class="built_in">empty</span>()) ++ans;</span><br><span class="line">        st.<span class="built_in">push</span>(&#123;ar[i], cnt&#125;);</span><br><span class="line">        <span class="comment">//cout &lt;&lt; i &lt;&lt; &#x27; &#x27; &lt;&lt; ans &lt;&lt; &#x27;\n&#x27;;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="四-单调栈优化dp"><a href="#四-单调栈优化dp" class="headerlink" title="四. 单调栈优化dp"></a>四. 单调栈优化dp</h2><h3 id="1-CF1313C2-Skyscrapers-hard-version"><a href="#1-CF1313C2-Skyscrapers-hard-version" class="headerlink" title="1.CF1313C2 Skyscrapers (hard version)"></a><a target="_blank" rel="noopener" href="https://codeforces.com/contest/1313/problem/C2">1.CF1313C2 Skyscrapers (hard version)</a></h3><p><img src="/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/b1204eee30fdc8610b05786a07723012.png" alt="img"><br><img src="/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/61d667061376a9b9588cbeac06f6a5cc.png" alt="img"><br><strong>题意：</strong><br>&emsp;&emsp;输入一个$n$，之后输入$n$个数字$ar[i]$。<br>&emsp;&emsp;让你选择一个点作为山峰。假设选择点$pos$作为山峰，其他的$n-1$点的高度将发生变化。假设修改后的高度记为$h[i]$,对于<code>1~pos-1</code>中的一个点<code>i</code>,必须满足$h[i]=min(h[i+1],ar[i])$，对于<code>pos+1~n</code>中的一个点<code>i</code>,必须满足$h[i] = min(h[i-1],ar[i])$。求$\sum_1^n h[i]$的最大值。输出取最大值时的<code>h[i]</code>数组。<br><strong>分析：</strong><br>&emsp;&emsp;首先，我们可以看一下<a target="_blank" rel="noopener" href="https://codeforces.com/contest/1313/problem/C1">easy版本</a>。区别在于n的大小。easy版本n最大1000。$O(n^2)$能过。我们考虑dp，定义<code>dp1[i],dp2[i]</code>分别表示选择$i$作为山峰时$i$极其左侧的最大值。答案就是$max(dp1[i]+dp2[i]-ar[i])$。<br>&emsp;&emsp;我们考虑快速求<code>dp1[i]</code>的方法，假设<code>ar[j]</code>是$i$之前第一个满足<code>ar[j]&lt;=ar[i]</code>的元素，那么$dp1[i]=dp1[j]+(i-j)\times ar[i]$。而对于第一个小于等于的元素，显然可以利用单调栈快速找出。（<code>dp2</code>求法同理）复杂度$O(n)$。<br>&emsp;&emsp;（单调栈用法1，利用单调栈找到区间内第一个比他大/小的元素)<br><strong>AC代码：</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n, pos;</span><br><span class="line">ll ar[<span class="number">500050</span>];</span><br><span class="line">ll dp1[<span class="number">500050</span>];</span><br><span class="line">ll dp2[<span class="number">500050</span>];</span><br><span class="line">ll ans[<span class="number">500050</span>];</span><br><span class="line">ll mx;</span><br><span class="line">stack&lt;ll&gt; st;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">work</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> tmp = pos;</span><br><span class="line">    ll mxx = ar[tmp];</span><br><span class="line">    ans[tmp] = ar[tmp];</span><br><span class="line">    <span class="keyword">while</span>(tmp &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        --tmp;</span><br><span class="line">        ans[tmp] = <span class="built_in">min</span>(mxx, ar[tmp]);</span><br><span class="line">        mxx = ans[tmp];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    tmp = pos;</span><br><span class="line">    mxx = ar[tmp];</span><br><span class="line">    <span class="keyword">while</span>(tmp &lt; n)</span><br><span class="line">    &#123;</span><br><span class="line">        ++tmp;</span><br><span class="line">        ans[tmp] = <span class="built_in">min</span>(mxx, ar[tmp]);</span><br><span class="line">        mxx = ans[tmp];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">printf</span>(<span class="string">&quot;%lld &quot;</span>, ans[i]);</span><br><span class="line">    <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;ar[i]);</span><br><span class="line"></span><br><span class="line">    st.<span class="built_in">push</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(!st.<span class="built_in">empty</span>() &amp;&amp; ar[st.<span class="built_in">top</span>()] &gt;= ar[i]) st.<span class="built_in">pop</span>();</span><br><span class="line"></span><br><span class="line">        dp1[i] = dp1[st.<span class="built_in">top</span>()] + (i - st.<span class="built_in">top</span>()) * ar[i];</span><br><span class="line">        st.<span class="built_in">push</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(!st.<span class="built_in">empty</span>()) st.<span class="built_in">pop</span>();</span><br><span class="line">    st.<span class="built_in">push</span>(n + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = n; i &gt; <span class="number">0</span>; --i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(!st.<span class="built_in">empty</span>() &amp;&amp; ar[st.<span class="built_in">top</span>()] &gt;= ar[i]) st.<span class="built_in">pop</span>();</span><br><span class="line"></span><br><span class="line">        dp2[i] = dp2[st.<span class="built_in">top</span>()] + (st.<span class="built_in">top</span>() - i) * ar[i];</span><br><span class="line">        st.<span class="built_in">push</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(dp1[i] + dp2[i] - ar[i] &gt; mx)</span><br><span class="line">        &#123;</span><br><span class="line">            mx = dp1[i] + dp2[i] - ar[i];</span><br><span class="line">            pos = i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">work</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/172a8302125abb4035ffdd377aa6f16f.png" alt="img"><br>（295是正解，换成解绑之后的cin，cout用线段树暴力维护居然卡过了)。</p>
<h3 id="2-CF1407D-Discrete-Centrifugal-Jumps"><a href="#2-CF1407D-Discrete-Centrifugal-Jumps" class="headerlink" title="2.CF1407D Discrete Centrifugal Jumps"></a><a target="_blank" rel="noopener" href="https://codeforces.com/contest/1407/problem/D">2.CF1407D Discrete Centrifugal Jumps</a></h3><p><img src="/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/a861c53c156d8edaad6c5a9aa1f4ca4b.png" alt="img"><br><img src="/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/1de67106f57af303b9bb963de67a3079.png" alt="img"><br><strong>题意：</strong><br>&emsp;&emsp;输入一个<code>n</code>，之后<code>n</code>个数字<code>ar[i]</code>。<br>&emsp;&emsp;一开始你在位置<code>1</code>，你要到达位置<code>n</code>，从位置<code>i</code>到位置<code>j</code>必须满足一下条件之一。<br><img src="/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/55b54c960fa31c4dd2f54275c08b1de6.png" alt="img"><br>&emsp;&emsp;问你到达<code>n</code>最少需要跳几步。<br><strong>分析：</strong><br>&emsp;&emsp;单调栈的用法2，找两元素间所有元素均(不)大/小于这两者<br><img src="/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/016b693039c580ca26e453d8fe39e464-172236852184526.png" alt="img"><br>（区间1~i内元素大小关系和单调栈内元素情况）<br>&emsp;&emsp;借助这个图理解和<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1823">P1823 [COI2007] Patrik 音乐会的等待</a>这个题理解一下。<br><strong>AC代码：</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line">stack&lt;<span class="type">int</span>&gt; st1, st2;</span><br><span class="line"><span class="type">int</span> dp[<span class="number">300050</span>];</span><br><span class="line"><span class="type">int</span> ar[<span class="number">300050</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;ar[i]);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">memset</span>(dp, <span class="number">0x3f</span>, <span class="built_in">sizeof</span>(dp));</span><br><span class="line"></span><br><span class="line">    dp[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        dp[i] = <span class="built_in">min</span>(dp[i], dp[i - <span class="number">1</span>] + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">while</span>(!st<span class="number">1.</span><span class="built_in">empty</span>() &amp;&amp; ar[st<span class="number">1.</span><span class="built_in">top</span>()] &lt;= ar[i])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> pos = st<span class="number">1.</span><span class="built_in">top</span>();</span><br><span class="line">            st<span class="number">1.</span><span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">if</span>(!st<span class="number">1.</span><span class="built_in">empty</span>() &amp;&amp; ar[i] &gt; ar[pos]) dp[i] = <span class="built_in">min</span>(dp[st<span class="number">1.</span><span class="built_in">top</span>()] + <span class="number">1</span>, dp[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        st<span class="number">1.</span><span class="built_in">push</span>(i);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>(!st<span class="number">2.</span><span class="built_in">empty</span>() &amp;&amp; ar[st<span class="number">2.</span><span class="built_in">top</span>()] &gt;= ar[i])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> pos = st<span class="number">2.</span><span class="built_in">top</span>();</span><br><span class="line">            st<span class="number">2.</span><span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">if</span>(!st<span class="number">2.</span><span class="built_in">empty</span>() &amp;&amp; ar[i] &lt; ar[pos]) dp[i] = <span class="built_in">min</span>(dp[st<span class="number">2.</span><span class="built_in">top</span>()] + <span class="number">1</span>, dp[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        st<span class="number">2.</span><span class="built_in">push</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, dp[n]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="3-牛客多校第九场I-The-Great-Wall-II"><a href="#3-牛客多校第九场I-The-Great-Wall-II" class="headerlink" title="3.牛客多校第九场I The Great Wall II"></a><a target="_blank" rel="noopener" href="https://ac.nowcoder.com/acm/contest/33194/I">3.牛客多校第九场I The Great Wall II</a></h3><p><img src="/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/37bc0be278f5c2c2e5fb7604d265173d.png" alt="img"><br><img src="/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/1551f106df7eceffa6462d5d3729ae95.png" alt="img"><br><img src="/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/e0f64eceb49d6e8a61f074fd31a2d233.png" alt="img"><br><strong>题意：</strong><br>&emsp;&emsp;输入一个<code>n</code>，之后输入数组<code>ar[n]</code>。你需要将区间<code>[1,n]</code>分成<code>k</code>个子区间，这<code>k</code>个区间两两不交，且并集是全集。每个子区间的值是这个区间中最大的那个数字，你需要最小化这<code>k</code>个区间的值的和。输出<code>k</code>取<code>1~n</code>时对应的答案。<br><strong>分析：</strong><br>官方题解：<br><img src="/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/b7274956152febba7640ebfb67851834.png" alt="img"></p>
<p><img src="/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/7d7b5244a73c0aa14c94ab1a0aaddf33.png" alt="img"></p>
<p><img src="/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/13752590745cf3a8f3db55fa6a7739f5-172236927170935.png" alt="img"></p>
<p>说人话：<br><img src="/2022/11/03/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97-%E5%8D%95%E8%B0%83%E6%A0%88%E4%BC%98%E5%8C%96dp/7b8893ab0abbdaded9da9d361358e5c7.jpeg" alt="img"></p>
<p><strong>AC代码：</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> inf = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">int</span> ar[<span class="number">8005</span>];</span><br><span class="line"><span class="type">int</span> dp[<span class="number">8005</span>][<span class="number">8005</span>];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> val, mi, mi_dp;<span class="comment">//ar[k],dp[k][j - 1],min(dp[k][j])</span></span><br><span class="line">&#125;st[<span class="number">8005</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;ar[i]);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">memset</span>(dp, <span class="number">0x3f</span>, <span class="built_in">sizeof</span>(dp));</span><br><span class="line"></span><br><span class="line">    dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; ++j)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> top = <span class="number">1</span>;</span><br><span class="line">        st[top] = &#123;inf, inf, inf&#125;;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> mi = dp[i - <span class="number">1</span>][j - <span class="number">1</span>];</span><br><span class="line">            <span class="keyword">while</span>(top &gt;= <span class="number">1</span> &amp;&amp; st[top].val &lt;= ar[i]) mi = <span class="built_in">min</span>(mi, st[top--].mi);</span><br><span class="line">            st[top + <span class="number">1</span>] = &#123;ar[i], mi, <span class="built_in">min</span>(mi + ar[i], st[top].mi_dp)&#125;;</span><br><span class="line">            ++top;</span><br><span class="line">            dp[i][j] = st[top].mi_dp;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, dp[n][j]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92DP/" rel="tag"># 动态规划DP</a>
              <a href="/tags/DP%E4%BC%98%E5%8C%96/" rel="tag"># DP优化</a>
              <a href="/tags/%E5%8D%95%E8%B0%83%E6%A0%88/" rel="tag"># 单调栈</a>
              <a href="/tags/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97/" rel="tag"># 单调队列</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/10/30/Codeforces-Round-829-Div-2/" rel="prev" title="Codeforces Round#829 (Div. 2)">
                  <i class="fa fa-angle-left"></i> Codeforces Round#829 (Div. 2)
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2022/11/11/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E3%80%90%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84%E3%80%91-%E3%80%90%E7%BA%BF%E6%AE%B5%E6%A0%91%E3%80%91-%E3%80%90%E7%8F%82%E6%9C%B5%E8%8E%89%E6%A0%91%E3%80%91/" rel="next" title="数据结构 【树状数组】 【线段树】 【珂朵莉树】">
                  数据结构 【树状数组】 【线段树】 【珂朵莉树】 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Asuka</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  






  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
